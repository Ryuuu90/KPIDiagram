{"ast":null,"code":"var _jsxFileName = \"/Users/khalidabourkia/Desktop/diagram/client/src/components/KPIDiagram.jsx\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport ReactFlow, { Background, Controls, useNodesState, useEdgesState, Handle, Position } from 'reactflow';\nimport 'reactflow/dist/style.css';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CustomNode = ({\n  data\n}) => {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      border: '1px solid #ccc',\n      padding: '12px 16px',\n      borderRadius: 12,\n      background: '#fff',\n      boxShadow: '0 2px 8px rgba(0,0,0,0.1)',\n      minWidth: 180,\n      maxWidth: 200,\n      textAlign: 'center',\n      fontSize: 14,\n      fontWeight: 500,\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(Handle, {\n      type: \"target\",\n      position: Position.Top,\n      id: \"a\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: 8\n      },\n      children: data.label\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 7\n    }, this), data.hasChildren && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: data.onDrill,\n      style: {\n        padding: '4px 8px',\n        fontSize: 12,\n        borderRadius: 6,\n        border: 'none',\n        background: '#007bff',\n        color: 'white',\n        cursor: 'pointer'\n      },\n      children: data.expanded ? '➖' : '➕'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Handle, {\n      type: \"source\",\n      position: Position.Bottom,\n      id: \"a\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 15,\n    columnNumber: 5\n  }, this);\n};\n_c = CustomNode;\nconst KPIDiagram = () => {\n  _s();\n  const [level, setLevel] = useState(0);\n  const newNodesRef = useRef([]);\n  const edgesRef = useRef([]);\n  const expandedNodesRef = useRef(new Set());\n  const drillInProgress = useRef(false);\n\n  // Store all fetched nodes and edges\n  const allNodesMap = useRef(new Map());\n  const allEdgesMap = useRef(new Map());\n  const [nodes, setNodes, onNodesChange] = useNodesState([]);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n  const nodeTypes = useMemo(() => ({\n    customNode: CustomNode\n  }), []);\n  const fetchNode = async nodeId => {\n    try {\n      const res = await axios.get(`http://localhost:8000/api/node/${nodeId}`);\n      return res.data.node;\n    } catch (error) {\n      console.error('Error fetching node:', error);\n      return null;\n    }\n  };\n  const removeDescendants = parentId => {\n    const toRemove = new Set();\n    const stack = [parentId];\n    while (stack.length > 0) {\n      const current = stack.pop();\n      const children = edgesRef.current.filter(e => e.source === current).map(e => e.target);\n      children.forEach(childId => {\n        if (!toRemove.has(childId)) {\n          stack.push(childId);\n          toRemove.add(childId);\n        }\n      });\n    }\n    newNodesRef.current = newNodesRef.current.filter(n => !toRemove.has(n.id));\n    edgesRef.current = edgesRef.current.filter(e => !toRemove.has(e.target) && !toRemove.has(e.source));\n    for (const id of toRemove) expandedNodesRef.current.delete(id);\n    expandedNodesRef.current.delete(parentId);\n    newNodesRef.current = newNodesRef.current.map(n => n.id === parentId ? {\n      ...n,\n      data: {\n        ...n.data,\n        expanded: false\n      }\n    } : n);\n  };\n  const handleDrill = useCallback(async nodeId => {\n    var _parentNode$position;\n    if (drillInProgress.current) return; // prevent multiple simultaneous drills\n    drillInProgress.current = true;\n    const isExpanded = expandedNodesRef.current.has(nodeId);\n    if (isExpanded) {\n      removeDescendants(nodeId);\n      setNodes([...newNodesRef.current]);\n      setEdges([...edgesRef.current]);\n      drillInProgress.current = false;\n      return;\n    }\n    const node = await fetchNode(nodeId);\n    if (!node || !node.childrenData) {\n      drillInProgress.current = false;\n      return;\n    }\n    const parentNode = newNodesRef.current.find(n => n.id === nodeId);\n    const nextLevel = parseInt(node.level) + 1 || level + 1;\n    const centerX = (parentNode === null || parentNode === void 0 ? void 0 : (_parentNode$position = parentNode.position) === null || _parentNode$position === void 0 ? void 0 : _parentNode$position.x) || 0;\n    const entries = Object.entries(node.childrenData);\n    const totalChildren = entries.length;\n    const baseY = 100 + nextLevel * 180;\n    const spacing = Math.max(200, 1200 / totalChildren);\n    const startX = centerX - (totalChildren - 1) * spacing / 2;\n    entries.forEach(([childId, childLabel], index) => {\n      const childX = startX + index * spacing;\n      let newNode = allNodesMap.current.get(childId);\n      if (!newNode) {\n        newNode = {\n          id: childId,\n          type: 'customNode',\n          position: {\n            x: childX,\n            y: baseY\n          },\n          data: {\n            label: childLabel.label,\n            id: childId,\n            hasChildren: childLabel.hasChildren,\n            expanded: expandedNodesRef.current.has(childId),\n            onDrill: () => handleDrill(childId)\n          }\n        };\n        allNodesMap.current.set(childId, newNode);\n      } else {\n        newNode = {\n          ...newNode,\n          position: {\n            x: childX,\n            y: baseY\n          }\n        };\n        allNodesMap.current.set(childId, newNode);\n      }\n      const edgeId = `e-${nodeId}-${childId}`;\n      let newEdge = allEdgesMap.current.get(edgeId);\n      if (!newEdge) {\n        newEdge = {\n          id: edgeId,\n          source: nodeId,\n          sourceHandle: 'a',\n          target: childId,\n          targetHandle: 'a',\n          animated: true\n        };\n        allEdgesMap.current.set(edgeId, newEdge);\n      }\n      if (!newNodesRef.current.find(n => n.id === childId)) {\n        newNodesRef.current.push(newNode);\n      }\n      if (!edgesRef.current.find(e => e.id === newEdge.id)) {\n        edgesRef.current.push(newEdge);\n      }\n    });\n    const uniqueNodes = Array.from(new Map(newNodesRef.current.map(n => [n.id, n])).values());\n    const uniqueEdges = Array.from(new Map(edgesRef.current.map(e => [e.id, e])).values());\n    newNodesRef.current = uniqueNodes;\n    edgesRef.current = uniqueEdges;\n    expandedNodesRef.current.add(nodeId);\n    newNodesRef.current = newNodesRef.current.map(n => n.id === nodeId ? {\n      ...n,\n      data: {\n        ...n.data,\n        expanded: true\n      }\n    } : n);\n    setNodes([...uniqueNodes]);\n    setEdges([...uniqueEdges]);\n    setLevel(nextLevel);\n    drillInProgress.current = false;\n  }, [level]);\n  useEffect(() => {\n    const loadRoot = async () => {\n      const root = await fetchNode('EC140');\n      if (!root) return;\n      const rootId = root.parentId || 'EC140';\n      const rootNode = {\n        id: rootId,\n        type: 'customNode',\n        position: {\n          x: 500,\n          y: 50\n        },\n        data: {\n          label: root.parentName || 'Root Node',\n          id: rootId,\n          hasChildren: true,\n          expanded: false,\n          onDrill: () => handleDrill(rootId)\n        }\n      };\n      newNodesRef.current = [rootNode];\n      allNodesMap.current.set(rootId, rootNode);\n      setNodes([...newNodesRef.current]);\n    };\n    loadRoot();\n  }, [handleDrill]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: '100vw',\n      height: '100vh'\n    },\n    children: /*#__PURE__*/_jsxDEV(ReactFlow, {\n      nodes: nodes,\n      edges: edges,\n      onNodesChange: onNodesChange,\n      onEdgesChange: onEdgesChange,\n      nodeTypes: nodeTypes,\n      fitView: true,\n      fitViewOptions: {\n        padding: 0.4\n      },\n      children: [/*#__PURE__*/_jsxDEV(Background, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Controls, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 239,\n    columnNumber: 5\n  }, this);\n};\n_s(KPIDiagram, \"gMNmnfKPzHamoWiZeCu08f19DAI=\", false, function () {\n  return [useNodesState, useEdgesState];\n});\n_c2 = KPIDiagram;\nexport default KPIDiagram;\nvar _c, _c2;\n$RefreshReg$(_c, \"CustomNode\");\n$RefreshReg$(_c2, \"KPIDiagram\");","map":{"version":3,"names":["React","useCallback","useEffect","useMemo","useRef","useState","ReactFlow","Background","Controls","useNodesState","useEdgesState","Handle","Position","axios","jsxDEV","_jsxDEV","CustomNode","data","style","border","padding","borderRadius","background","boxShadow","minWidth","maxWidth","textAlign","fontSize","fontWeight","position","children","type","Top","id","fileName","_jsxFileName","lineNumber","columnNumber","marginBottom","label","hasChildren","onClick","onDrill","color","cursor","expanded","Bottom","_c","KPIDiagram","_s","level","setLevel","newNodesRef","edgesRef","expandedNodesRef","Set","drillInProgress","allNodesMap","Map","allEdgesMap","nodes","setNodes","onNodesChange","edges","setEdges","onEdgesChange","nodeTypes","customNode","fetchNode","nodeId","res","get","node","error","console","removeDescendants","parentId","toRemove","stack","length","current","pop","filter","e","source","map","target","forEach","childId","has","push","add","n","delete","handleDrill","_parentNode$position","isExpanded","childrenData","parentNode","find","nextLevel","parseInt","centerX","x","entries","Object","totalChildren","baseY","spacing","Math","max","startX","childLabel","index","childX","newNode","y","set","edgeId","newEdge","sourceHandle","targetHandle","animated","uniqueNodes","Array","from","values","uniqueEdges","loadRoot","root","rootId","rootNode","parentName","width","height","fitView","fitViewOptions","_c2","$RefreshReg$"],"sources":["/Users/khalidabourkia/Desktop/diagram/client/src/components/KPIDiagram.jsx"],"sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport ReactFlow, {\n  Background,\n  Controls,\n  useNodesState,\n  useEdgesState,\n  Handle,\n  Position,\n} from 'reactflow';\nimport 'reactflow/dist/style.css';\nimport axios from 'axios';\n\nconst CustomNode = ({ data }) => {\n  return (\n    <div\n      style={{\n        border: '1px solid #ccc',\n        padding: '12px 16px',\n        borderRadius: 12,\n        background: '#fff',\n        boxShadow: '0 2px 8px rgba(0,0,0,0.1)',\n        minWidth: 180,\n        maxWidth: 200,\n        textAlign: 'center',\n        fontSize: 14,\n        fontWeight: 500,\n        position: 'relative',\n      }}\n    >\n      <Handle type=\"target\" position={Position.Top} id=\"a\" />\n      <div style={{ marginBottom: 8 }}>{data.label}</div>\n      {data.hasChildren && (\n        <button\n          onClick={data.onDrill}\n          style={{\n            padding: '4px 8px',\n            fontSize: 12,\n            borderRadius: 6,\n            border: 'none',\n            background: '#007bff',\n            color: 'white',\n            cursor: 'pointer',\n          }}\n        >\n          {data.expanded ? '➖' : '➕'}\n        </button>\n      )}\n      <Handle type=\"source\" position={Position.Bottom} id=\"a\" />\n    </div>\n  );\n};\n\nconst KPIDiagram = () => {\n  const [level, setLevel] = useState(0);\n  const newNodesRef = useRef([]);\n  const edgesRef = useRef([]);\n  const expandedNodesRef = useRef(new Set());\n  const drillInProgress = useRef(false);\n\n  // Store all fetched nodes and edges\n  const allNodesMap = useRef(new Map());\n  const allEdgesMap = useRef(new Map());\n\n  const [nodes, setNodes, onNodesChange] = useNodesState([]);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n  const nodeTypes = useMemo(() => ({ customNode: CustomNode }), []);\n\n  const fetchNode = async (nodeId) => {\n    try {\n      const res = await axios.get(`http://localhost:8000/api/node/${nodeId}`);\n      return res.data.node;\n    } catch (error) {\n      console.error('Error fetching node:', error);\n      return null;\n    }\n  };\n\n  const removeDescendants = (parentId) => {\n    const toRemove = new Set();\n    const stack = [parentId];\n\n    while (stack.length > 0) {\n      const current = stack.pop();\n\n      const children = edgesRef.current\n        .filter((e) => e.source === current)\n        .map((e) => e.target);\n\n      children.forEach((childId) => {\n        if (!toRemove.has(childId)) {\n          stack.push(childId);\n          toRemove.add(childId);\n        }\n      });\n    }\n\n    newNodesRef.current = newNodesRef.current.filter((n) => !toRemove.has(n.id));\n    edgesRef.current = edgesRef.current.filter(\n      (e) => !toRemove.has(e.target) && !toRemove.has(e.source)\n    );\n\n    for (const id of toRemove) expandedNodesRef.current.delete(id);\n    expandedNodesRef.current.delete(parentId);\n\n    newNodesRef.current = newNodesRef.current.map((n) =>\n      n.id === parentId ? { ...n, data: { ...n.data, expanded: false } } : n\n    );\n  };\n\n  const handleDrill = useCallback(\n    async (nodeId) => {\n      if (drillInProgress.current) return; // prevent multiple simultaneous drills\n      drillInProgress.current = true;\n\n      const isExpanded = expandedNodesRef.current.has(nodeId);\n\n      if (isExpanded) {\n        removeDescendants(nodeId);\n        setNodes([...newNodesRef.current]);\n        setEdges([...edgesRef.current]);\n        drillInProgress.current = false;\n        return;\n      }\n\n      const node = await fetchNode(nodeId);\n      if (!node || !node.childrenData) {\n        drillInProgress.current = false;\n        return;\n      }\n\n      const parentNode = newNodesRef.current.find((n) => n.id === nodeId);\n      const nextLevel = parseInt(node.level) + 1 || level + 1;\n      const centerX = parentNode?.position?.x || 0;\n\n      const entries = Object.entries(node.childrenData);\n      const totalChildren = entries.length;\n      const baseY = 100 + nextLevel * 180;\n      const spacing = Math.max(200, 1200 / totalChildren);\n      const startX = centerX - ((totalChildren - 1) * spacing) / 2;\n\n      entries.forEach(([childId, childLabel], index) => {\n        const childX = startX + index * spacing;\n\n        let newNode = allNodesMap.current.get(childId);\n        if (!newNode) {\n          newNode = {\n            id: childId,\n            type: 'customNode',\n            position: { x: childX, y: baseY },\n            data: {\n              label: childLabel.label,\n              id: childId,\n              hasChildren: childLabel.hasChildren,\n              expanded: expandedNodesRef.current.has(childId),\n              onDrill: () => handleDrill(childId),\n            },\n          };\n          allNodesMap.current.set(childId, newNode);\n        } else {\n          newNode = { ...newNode, position: { x: childX, y: baseY } };\n          allNodesMap.current.set(childId, newNode);\n        }\n\n        const edgeId = `e-${nodeId}-${childId}`;\n        let newEdge = allEdgesMap.current.get(edgeId);\n        if (!newEdge) {\n          newEdge = {\n            id: edgeId,\n            source: nodeId,\n            sourceHandle: 'a',\n            target: childId,\n            targetHandle: 'a',\n            animated: true,\n          };\n          allEdgesMap.current.set(edgeId, newEdge);\n        }\n\n        if (!newNodesRef.current.find((n) => n.id === childId)) {\n          newNodesRef.current.push(newNode);\n        }\n        if (!edgesRef.current.find((e) => e.id === newEdge.id)) {\n          edgesRef.current.push(newEdge);\n        }\n      });\n\n      const uniqueNodes = Array.from(\n        new Map(newNodesRef.current.map((n) => [n.id, n])).values()\n      );\n      const uniqueEdges = Array.from(\n        new Map(edgesRef.current.map((e) => [e.id, e])).values()\n      );\n\n      newNodesRef.current = uniqueNodes;\n      edgesRef.current = uniqueEdges;\n      expandedNodesRef.current.add(nodeId);\n\n      newNodesRef.current = newNodesRef.current.map((n) =>\n        n.id === nodeId ? { ...n, data: { ...n.data, expanded: true } } : n\n      );\n\n      setNodes([...uniqueNodes]);\n      setEdges([...uniqueEdges]);\n      setLevel(nextLevel);\n\n      drillInProgress.current = false;\n    },\n    [level]\n  );\n\n  useEffect(() => {\n    const loadRoot = async () => {\n      const root = await fetchNode('EC140');\n      if (!root) return;\n\n      const rootId = root.parentId || 'EC140';\n      const rootNode = {\n        id: rootId,\n        type: 'customNode',\n        position: { x: 500, y: 50 },\n        data: {\n          label: root.parentName || 'Root Node',\n          id: rootId,\n          hasChildren: true,\n          expanded: false,\n          onDrill: () => handleDrill(rootId),\n        },\n      };\n\n      newNodesRef.current = [rootNode];\n      allNodesMap.current.set(rootId, rootNode);\n\n      setNodes([...newNodesRef.current]);\n    };\n\n    loadRoot();\n  }, [handleDrill]);\n\n  return (\n    <div style={{ width: '100vw', height: '100vh' }}>\n      <ReactFlow\n        nodes={nodes}\n        edges={edges}\n        onNodesChange={onNodesChange}\n        onEdgesChange={onEdgesChange}\n        nodeTypes={nodeTypes}\n        fitView\n        fitViewOptions={{ padding: 0.4 }}\n      >\n        <Background />\n        <Controls />\n      </ReactFlow>\n    </div>\n  );\n};\n\nexport default KPIDiagram;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}