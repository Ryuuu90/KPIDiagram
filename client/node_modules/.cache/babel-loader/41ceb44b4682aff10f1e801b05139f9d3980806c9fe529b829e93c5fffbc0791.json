{"ast":null,"code":"var _jsxFileName = \"/Users/khalidabourkia/Desktop/diagram/client/src/components/KPIDiagram.jsx\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport ReactFlow, { Background, Controls, useNodesState, useEdgesState, Handle, Position } from 'reactflow';\nimport 'reactflow/dist/style.css';\nimport axios from 'axios';\n\n// CustomNode component\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CustomNode = ({\n  data\n}) => {\n  return /*#__PURE__*/_jsxDEV(AnimatePresence, {\n    children: !data.collapsing && /*#__PURE__*/_jsxDEV(motion.div, {\n      initial: {\n        opacity: 0,\n        scale: 0.8\n      },\n      animate: {\n        opacity: 1,\n        scale: 1\n      },\n      exit: {\n        opacity: 0,\n        scale: 0.8\n      },\n      transition: {\n        duration: 0.4\n      },\n      style: {\n        border: '1px solid #ccc',\n        padding: '12px 16px',\n        borderRadius: 12,\n        background: '#fff',\n        boxShadow: '0 2px 8px rgba(0,0,0,0.1)',\n        minWidth: 180,\n        maxWidth: 200,\n        textAlign: 'center',\n        fontSize: 14,\n        fontWeight: 500,\n        position: 'relative'\n      },\n      layout: true,\n      children: [/*#__PURE__*/_jsxDEV(Handle, {\n        type: \"target\",\n        position: Position.Top,\n        id: \"a\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 8\n        },\n        children: data.label\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 11\n      }, this), data.hasChildren && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: data.onDrill,\n        style: {\n          padding: '4px 8px',\n          fontSize: 12,\n          borderRadius: 6,\n          border: 'none',\n          background: '#007bff',\n          color: 'white',\n          cursor: 'pointer'\n        },\n        children: data.expanded ? '➖' : '➕'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(Handle, {\n        type: \"source\",\n        position: Position.Bottom,\n        id: \"a\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 11\n      }, this)]\n    }, data.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 19,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 17,\n    columnNumber: 5\n  }, this);\n};\n_c = CustomNode;\nconst KPIDiagram = () => {\n  _s();\n  const [level, setLevel] = useState(0);\n  const newNodesRef = useRef([]);\n  const edgesRef = useRef([]);\n  const expandedNodesRef = useRef(new Set()); // Track expanded nodes\n\n  const [nodes, setNodes, onNodesChange] = useNodesState([]);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n  const nodeTypes = useMemo(() => ({\n    customNode: CustomNode\n  }), []);\n  const fetchNode = async nodeId => {\n    try {\n      const res = await axios.get(`http://localhost:8000/api/node/${nodeId}`);\n      return res.data.node;\n    } catch (error) {\n      console.error('Error fetching node:', error);\n      return null;\n    }\n  };\n  const handleDrill = useCallback(async nodeId => {\n    var _parentNode$position;\n    const isExpanded = expandedNodesRef.current.has(nodeId);\n    if (isExpanded) {\n      // Find nodes to collapse: children of nodeId\n      const childrenToCollapse = new Set(edgesRef.current.filter(e => e.source === nodeId).map(e => e.target));\n\n      // Step 1: mark those nodes as collapsing, keep them in the state\n      newNodesRef.current = newNodesRef.current.map(n => childrenToCollapse.has(n.id) ? {\n        ...n,\n        data: {\n          ...n.data,\n          collapsing: true\n        }\n      } : n);\n      setNodes([...newNodesRef.current]);\n\n      // Step 2: after 400ms, remove nodes and edges permanently\n      setTimeout(() => {\n        const updatedNodes = newNodesRef.current.filter(n => !edgesRef.current.some(e => e.source === nodeId && e.target === n.id));\n        const updatedEdges = edgesRef.current.filter(e => e.source !== nodeId);\n        newNodesRef.current = updatedNodes;\n        edgesRef.current = updatedEdges;\n        expandedNodesRef.current.delete(nodeId);\n\n        // Update expanded flag on parent node\n        newNodesRef.current = newNodesRef.current.map(n => n.id === nodeId ? {\n          ...n,\n          data: {\n            ...n.data,\n            expanded: false\n          }\n        } : n);\n        setNodes([...newNodesRef.current]);\n        setEdges([...edgesRef.current]);\n      }, 400);\n      return;\n    }\n\n    // Expand\n    const node = await fetchNode(nodeId);\n    if (!node || !node.childrenData) return;\n    const parentId = node.parentId || nodeId;\n    const nextLevel = parseInt(node.level) + 1 || level + 1;\n    const entries = Object.entries(node.childrenData);\n    const totalChildren = entries.length;\n    const baseY = 100 + nextLevel * 180;\n    const parentNode = newNodesRef.current.find(n => n.id === nodeId);\n    const centerX = (parentNode === null || parentNode === void 0 ? void 0 : (_parentNode$position = parentNode.position) === null || _parentNode$position === void 0 ? void 0 : _parentNode$position.x) || 0;\n    const spacing = Math.max(200, 1200 / totalChildren);\n    const startX = centerX - (totalChildren - 1) * spacing / 2;\n    entries.forEach(([childId, childLabel], index) => {\n      const childX = startX + index * spacing;\n      edgesRef.current.push({\n        id: `e-${nodeId}-${childId}`,\n        source: nodeId,\n        sourceHandle: 'a',\n        target: childId,\n        targetHandle: 'a',\n        animated: true\n      });\n      newNodesRef.current.push({\n        id: childId,\n        type: 'customNode',\n        position: {\n          x: childX,\n          y: baseY\n        },\n        data: {\n          label: childLabel.label,\n          id: childId,\n          hasChildren: childLabel.hasChildren,\n          expanded: false,\n          onDrill: () => handleDrill(childId)\n        }\n      });\n    });\n    expandedNodesRef.current.add(nodeId);\n\n    // Update parent node with `expanded: true`\n    newNodesRef.current = newNodesRef.current.map(n => n.id === nodeId ? {\n      ...n,\n      data: {\n        ...n.data,\n        expanded: true\n      }\n    } : n);\n\n    // Deduplicate\n    const uniqueNodes = Array.from(new Map(newNodesRef.current.map(n => [n.id, n])).values());\n    const uniqueEdges = Array.from(new Map(edgesRef.current.map(e => [e.id, e])).values());\n    setNodes(uniqueNodes);\n    setEdges(uniqueEdges);\n    setLevel(nextLevel);\n  }, [level]);\n  useEffect(() => {\n    const loadRoot = async () => {\n      const root = await fetchNode('EC140');\n      if (!root) return;\n      const rootId = root.parentId || 'EC140';\n      newNodesRef.current.push({\n        id: rootId,\n        type: 'customNode',\n        position: {\n          x: 500,\n          y: 50\n        },\n        data: {\n          label: root.parentName || 'Root Node',\n          id: rootId,\n          hasChildren: true,\n          expanded: false,\n          onDrill: () => handleDrill(rootId)\n        }\n      });\n      setNodes([...newNodesRef.current]);\n    };\n    loadRoot();\n  }, [handleDrill]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: '100vw',\n      height: '100vh'\n    },\n    children: /*#__PURE__*/_jsxDEV(ReactFlow, {\n      nodes: nodes,\n      edges: edges,\n      onNodesChange: onNodesChange,\n      onEdgesChange: onEdgesChange,\n      nodeTypes: nodeTypes,\n      fitView: true,\n      fitViewOptions: {\n        padding: 0.4\n      },\n      children: [/*#__PURE__*/_jsxDEV(Background, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Controls, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 216,\n    columnNumber: 5\n  }, this);\n};\n_s(KPIDiagram, \"HbHzJQdz/woi3PImq1fp6YbWOLQ=\", false, function () {\n  return [useNodesState, useEdgesState];\n});\n_c2 = KPIDiagram;\nexport default KPIDiagram;\nvar _c, _c2;\n$RefreshReg$(_c, \"CustomNode\");\n$RefreshReg$(_c2, \"KPIDiagram\");","map":{"version":3,"names":["React","useCallback","useEffect","useMemo","useRef","useState","motion","AnimatePresence","ReactFlow","Background","Controls","useNodesState","useEdgesState","Handle","Position","axios","jsxDEV","_jsxDEV","CustomNode","data","children","collapsing","div","initial","opacity","scale","animate","exit","transition","duration","style","border","padding","borderRadius","background","boxShadow","minWidth","maxWidth","textAlign","fontSize","fontWeight","position","layout","type","Top","id","fileName","_jsxFileName","lineNumber","columnNumber","marginBottom","label","hasChildren","onClick","onDrill","color","cursor","expanded","Bottom","_c","KPIDiagram","_s","level","setLevel","newNodesRef","edgesRef","expandedNodesRef","Set","nodes","setNodes","onNodesChange","edges","setEdges","onEdgesChange","nodeTypes","customNode","fetchNode","nodeId","res","get","node","error","console","handleDrill","_parentNode$position","isExpanded","current","has","childrenToCollapse","filter","e","source","map","target","n","setTimeout","updatedNodes","some","updatedEdges","delete","childrenData","parentId","nextLevel","parseInt","entries","Object","totalChildren","length","baseY","parentNode","find","centerX","x","spacing","Math","max","startX","forEach","childId","childLabel","index","childX","push","sourceHandle","targetHandle","animated","y","add","uniqueNodes","Array","from","Map","values","uniqueEdges","loadRoot","root","rootId","parentName","width","height","fitView","fitViewOptions","_c2","$RefreshReg$"],"sources":["/Users/khalidabourkia/Desktop/diagram/client/src/components/KPIDiagram.jsx"],"sourcesContent":["import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport ReactFlow, {\n  Background,\n  Controls,\n  useNodesState,\n  useEdgesState,\n  Handle,\n  Position,\n} from 'reactflow';\nimport 'reactflow/dist/style.css';\nimport axios from 'axios';\n\n// CustomNode component\nconst CustomNode = ({ data }) => {\n  return (\n    <AnimatePresence>\n      {!data.collapsing && (\n        <motion.div\n          initial={{ opacity: 0, scale: 0.8 }}\n          animate={{ opacity: 1, scale: 1 }}\n          exit={{ opacity: 0, scale: 0.8 }}\n          transition={{ duration: 0.4 }}\n          style={{\n            border: '1px solid #ccc',\n            padding: '12px 16px',\n            borderRadius: 12,\n            background: '#fff',\n            boxShadow: '0 2px 8px rgba(0,0,0,0.1)',\n            minWidth: 180,\n            maxWidth: 200,\n            textAlign: 'center',\n            fontSize: 14,\n            fontWeight: 500,\n            position: 'relative',\n          }}\n          layout\n          key={data.id}\n        >\n          <Handle type=\"target\" position={Position.Top} id=\"a\" />\n          <div style={{ marginBottom: 8 }}>{data.label}</div>\n          {data.hasChildren && (\n            <button\n              onClick={data.onDrill}\n              style={{\n                padding: '4px 8px',\n                fontSize: 12,\n                borderRadius: 6,\n                border: 'none',\n                background: '#007bff',\n                color: 'white',\n                cursor: 'pointer',\n              }}\n            >\n              {data.expanded ? '➖' : '➕'}\n            </button>\n          )}\n          <Handle type=\"source\" position={Position.Bottom} id=\"a\" />\n        </motion.div>\n      )}\n    </AnimatePresence>\n  );\n};\n\nconst KPIDiagram = () => {\n  const [level, setLevel] = useState(0);\n  const newNodesRef = useRef([]);\n  const edgesRef = useRef([]);\n  const expandedNodesRef = useRef(new Set()); // Track expanded nodes\n\n  const [nodes, setNodes, onNodesChange] = useNodesState([]);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n\n  const nodeTypes = useMemo(() => ({ customNode: CustomNode }), []);\n\n  const fetchNode = async (nodeId) => {\n    try {\n      const res = await axios.get(`http://localhost:8000/api/node/${nodeId}`);\n      return res.data.node;\n    } catch (error) {\n      console.error('Error fetching node:', error);\n      return null;\n    }\n  };\n\n  const handleDrill = useCallback(\n    async (nodeId) => {\n      const isExpanded = expandedNodesRef.current.has(nodeId);\n\n      if (isExpanded) {\n        // Find nodes to collapse: children of nodeId\n        const childrenToCollapse = new Set(\n          edgesRef.current\n            .filter(e => e.source === nodeId)\n            .map(e => e.target)\n        );\n      \n        // Step 1: mark those nodes as collapsing, keep them in the state\n        newNodesRef.current = newNodesRef.current.map(n =>\n          childrenToCollapse.has(n.id)\n            ? { ...n, data: { ...n.data, collapsing: true } }\n            : n\n        );\n        setNodes([...newNodesRef.current]);\n      \n        // Step 2: after 400ms, remove nodes and edges permanently\n        setTimeout(() => {\n          const updatedNodes = newNodesRef.current.filter(n => !edgesRef.current.some(e => e.source === nodeId && e.target === n.id));\n          const updatedEdges = edgesRef.current.filter(e => e.source !== nodeId);\n  \n          newNodesRef.current = updatedNodes;\n          edgesRef.current = updatedEdges;\n          expandedNodesRef.current.delete(nodeId);\n      \n          // Update expanded flag on parent node\n          newNodesRef.current = newNodesRef.current.map(n =>\n            n.id === nodeId ? { ...n, data: { ...n.data, expanded: false } } : n\n          );\n      \n          setNodes([...newNodesRef.current]);\n          setEdges([...edgesRef.current]);\n        }, 400);\n      \n        return;\n      }\n\n      // Expand\n      const node = await fetchNode(nodeId);\n      if (!node || !node.childrenData) return;\n\n      const parentId = node.parentId || nodeId;\n      const nextLevel = parseInt(node.level) + 1 || level + 1;\n      const entries = Object.entries(node.childrenData);\n      const totalChildren = entries.length;\n      const baseY = 100 + nextLevel * 180;\n\n      const parentNode = newNodesRef.current.find((n) => n.id === nodeId);\n      const centerX = parentNode?.position?.x || 0;\n      const spacing = Math.max(200, 1200 / totalChildren);\n      const startX = centerX - ((totalChildren - 1) * spacing) / 2;\n\n      entries.forEach(([childId, childLabel], index) => {\n        const childX = startX + index * spacing;\n\n        edgesRef.current.push({\n          id: `e-${nodeId}-${childId}`,\n          source: nodeId,\n          sourceHandle: 'a',\n          target: childId,\n          targetHandle: 'a',\n          animated: true,\n        });\n\n        newNodesRef.current.push({\n          id: childId,\n          type: 'customNode',\n          position: { x: childX, y: baseY },\n          data: {\n            label: childLabel.label,\n            id: childId,\n            hasChildren: childLabel.hasChildren,\n            expanded: false,\n            onDrill: () => handleDrill(childId),\n          },\n        });\n      });\n\n      expandedNodesRef.current.add(nodeId);\n\n      // Update parent node with `expanded: true`\n      newNodesRef.current = newNodesRef.current.map(n =>\n        n.id === nodeId\n          ? {\n              ...n,\n              data: { ...n.data, expanded: true },\n            }\n          : n\n      );\n\n      // Deduplicate\n      const uniqueNodes = Array.from(new Map(newNodesRef.current.map((n) => [n.id, n])).values());\n      const uniqueEdges = Array.from(new Map(edgesRef.current.map((e) => [e.id, e])).values());\n\n      setNodes(uniqueNodes);\n      setEdges(uniqueEdges);\n      setLevel(nextLevel);\n    },\n    [level]\n  );\n\n  useEffect(() => {\n    const loadRoot = async () => {\n      const root = await fetchNode('EC140');\n      if (!root) return;\n\n      const rootId = root.parentId || 'EC140';\n      newNodesRef.current.push({\n        id: rootId,\n        type: 'customNode',\n        position: { x: 500, y: 50 },\n        data: {\n          label: root.parentName || 'Root Node',\n          id: rootId,\n          hasChildren: true,\n          expanded: false,\n          onDrill: () => handleDrill(rootId),\n        },\n      });\n\n      setNodes([...newNodesRef.current]);\n    };\n    loadRoot();\n  }, [handleDrill]);\n\n  return (\n    <div style={{ width: '100vw', height: '100vh' }}>\n      <ReactFlow\n        nodes={nodes}\n        edges={edges}\n        onNodesChange={onNodesChange}\n        onEdgesChange={onEdgesChange}\n        nodeTypes={nodeTypes}\n        fitView\n        fitViewOptions={{ padding: 0.4 }}\n      >\n        <Background />\n        <Controls />\n      </ReactFlow>\n    </div>\n  );\n};\n\nexport default KPIDiagram;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,WAAW,EAAEC,SAAS,EAAEC,OAAO,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AAChF,SAASC,MAAM,EAAEC,eAAe,QAAQ,eAAe;AACvD,OAAOC,SAAS,IACdC,UAAU,EACVC,QAAQ,EACRC,aAAa,EACbC,aAAa,EACbC,MAAM,EACNC,QAAQ,QACH,WAAW;AAClB,OAAO,0BAA0B;AACjC,OAAOC,KAAK,MAAM,OAAO;;AAEzB;AAAA,SAAAC,MAAA,IAAAC,OAAA;AACA,MAAMC,UAAU,GAAGA,CAAC;EAAEC;AAAK,CAAC,KAAK;EAC/B,oBACEF,OAAA,CAACV,eAAe;IAAAa,QAAA,EACb,CAACD,IAAI,CAACE,UAAU,iBACfJ,OAAA,CAACX,MAAM,CAACgB,GAAG;MACTC,OAAO,EAAE;QAAEC,OAAO,EAAE,CAAC;QAAEC,KAAK,EAAE;MAAI,CAAE;MACpCC,OAAO,EAAE;QAAEF,OAAO,EAAE,CAAC;QAAEC,KAAK,EAAE;MAAE,CAAE;MAClCE,IAAI,EAAE;QAAEH,OAAO,EAAE,CAAC;QAAEC,KAAK,EAAE;MAAI,CAAE;MACjCG,UAAU,EAAE;QAAEC,QAAQ,EAAE;MAAI,CAAE;MAC9BC,KAAK,EAAE;QACLC,MAAM,EAAE,gBAAgB;QACxBC,OAAO,EAAE,WAAW;QACpBC,YAAY,EAAE,EAAE;QAChBC,UAAU,EAAE,MAAM;QAClBC,SAAS,EAAE,2BAA2B;QACtCC,QAAQ,EAAE,GAAG;QACbC,QAAQ,EAAE,GAAG;QACbC,SAAS,EAAE,QAAQ;QACnBC,QAAQ,EAAE,EAAE;QACZC,UAAU,EAAE,GAAG;QACfC,QAAQ,EAAE;MACZ,CAAE;MACFC,MAAM;MAAAtB,QAAA,gBAGNH,OAAA,CAACJ,MAAM;QAAC8B,IAAI,EAAC,QAAQ;QAACF,QAAQ,EAAE3B,QAAQ,CAAC8B,GAAI;QAACC,EAAE,EAAC;MAAG;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACvDhC,OAAA;QAAKa,KAAK,EAAE;UAAEoB,YAAY,EAAE;QAAE,CAAE;QAAA9B,QAAA,EAAED,IAAI,CAACgC;MAAK;QAAAL,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,EAClD9B,IAAI,CAACiC,WAAW,iBACfnC,OAAA;QACEoC,OAAO,EAAElC,IAAI,CAACmC,OAAQ;QACtBxB,KAAK,EAAE;UACLE,OAAO,EAAE,SAAS;UAClBO,QAAQ,EAAE,EAAE;UACZN,YAAY,EAAE,CAAC;UACfF,MAAM,EAAE,MAAM;UACdG,UAAU,EAAE,SAAS;UACrBqB,KAAK,EAAE,OAAO;UACdC,MAAM,EAAE;QACV,CAAE;QAAApC,QAAA,EAEDD,IAAI,CAACsC,QAAQ,GAAG,GAAG,GAAG;MAAG;QAAAX,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACpB,CACT,eACDhC,OAAA,CAACJ,MAAM;QAAC8B,IAAI,EAAC,QAAQ;QAACF,QAAQ,EAAE3B,QAAQ,CAAC4C,MAAO;QAACb,EAAE,EAAC;MAAG;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IAAA,GApBrD9B,IAAI,CAAC0B,EAAE;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAqBF;EACb;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACc,CAAC;AAEtB,CAAC;AAACU,EAAA,GAhDIzC,UAAU;AAkDhB,MAAM0C,UAAU,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACvB,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAG1D,QAAQ,CAAC,CAAC,CAAC;EACrC,MAAM2D,WAAW,GAAG5D,MAAM,CAAC,EAAE,CAAC;EAC9B,MAAM6D,QAAQ,GAAG7D,MAAM,CAAC,EAAE,CAAC;EAC3B,MAAM8D,gBAAgB,GAAG9D,MAAM,CAAC,IAAI+D,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;;EAE5C,MAAM,CAACC,KAAK,EAAEC,QAAQ,EAAEC,aAAa,CAAC,GAAG3D,aAAa,CAAC,EAAE,CAAC;EAC1D,MAAM,CAAC4D,KAAK,EAAEC,QAAQ,EAAEC,aAAa,CAAC,GAAG7D,aAAa,CAAC,EAAE,CAAC;EAE1D,MAAM8D,SAAS,GAAGvE,OAAO,CAAC,OAAO;IAAEwE,UAAU,EAAEzD;EAAW,CAAC,CAAC,EAAE,EAAE,CAAC;EAEjE,MAAM0D,SAAS,GAAG,MAAOC,MAAM,IAAK;IAClC,IAAI;MACF,MAAMC,GAAG,GAAG,MAAM/D,KAAK,CAACgE,GAAG,CAAC,kCAAkCF,MAAM,EAAE,CAAC;MACvE,OAAOC,GAAG,CAAC3D,IAAI,CAAC6D,IAAI;IACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC5C,OAAO,IAAI;IACb;EACF,CAAC;EAED,MAAME,WAAW,GAAGlF,WAAW,CAC7B,MAAO4E,MAAM,IAAK;IAAA,IAAAO,oBAAA;IAChB,MAAMC,UAAU,GAAGnB,gBAAgB,CAACoB,OAAO,CAACC,GAAG,CAACV,MAAM,CAAC;IAEvD,IAAIQ,UAAU,EAAE;MACd;MACA,MAAMG,kBAAkB,GAAG,IAAIrB,GAAG,CAChCF,QAAQ,CAACqB,OAAO,CACbG,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,MAAM,KAAKd,MAAM,CAAC,CAChCe,GAAG,CAACF,CAAC,IAAIA,CAAC,CAACG,MAAM,CACtB,CAAC;;MAED;MACA7B,WAAW,CAACsB,OAAO,GAAGtB,WAAW,CAACsB,OAAO,CAACM,GAAG,CAACE,CAAC,IAC7CN,kBAAkB,CAACD,GAAG,CAACO,CAAC,CAACjD,EAAE,CAAC,GACxB;QAAE,GAAGiD,CAAC;QAAE3E,IAAI,EAAE;UAAE,GAAG2E,CAAC,CAAC3E,IAAI;UAAEE,UAAU,EAAE;QAAK;MAAE,CAAC,GAC/CyE,CACN,CAAC;MACDzB,QAAQ,CAAC,CAAC,GAAGL,WAAW,CAACsB,OAAO,CAAC,CAAC;;MAElC;MACAS,UAAU,CAAC,MAAM;QACf,MAAMC,YAAY,GAAGhC,WAAW,CAACsB,OAAO,CAACG,MAAM,CAACK,CAAC,IAAI,CAAC7B,QAAQ,CAACqB,OAAO,CAACW,IAAI,CAACP,CAAC,IAAIA,CAAC,CAACC,MAAM,KAAKd,MAAM,IAAIa,CAAC,CAACG,MAAM,KAAKC,CAAC,CAACjD,EAAE,CAAC,CAAC;QAC3H,MAAMqD,YAAY,GAAGjC,QAAQ,CAACqB,OAAO,CAACG,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,MAAM,KAAKd,MAAM,CAAC;QAEtEb,WAAW,CAACsB,OAAO,GAAGU,YAAY;QAClC/B,QAAQ,CAACqB,OAAO,GAAGY,YAAY;QAC/BhC,gBAAgB,CAACoB,OAAO,CAACa,MAAM,CAACtB,MAAM,CAAC;;QAEvC;QACAb,WAAW,CAACsB,OAAO,GAAGtB,WAAW,CAACsB,OAAO,CAACM,GAAG,CAACE,CAAC,IAC7CA,CAAC,CAACjD,EAAE,KAAKgC,MAAM,GAAG;UAAE,GAAGiB,CAAC;UAAE3E,IAAI,EAAE;YAAE,GAAG2E,CAAC,CAAC3E,IAAI;YAAEsC,QAAQ,EAAE;UAAM;QAAE,CAAC,GAAGqC,CACrE,CAAC;QAEDzB,QAAQ,CAAC,CAAC,GAAGL,WAAW,CAACsB,OAAO,CAAC,CAAC;QAClCd,QAAQ,CAAC,CAAC,GAAGP,QAAQ,CAACqB,OAAO,CAAC,CAAC;MACjC,CAAC,EAAE,GAAG,CAAC;MAEP;IACF;;IAEA;IACA,MAAMN,IAAI,GAAG,MAAMJ,SAAS,CAACC,MAAM,CAAC;IACpC,IAAI,CAACG,IAAI,IAAI,CAACA,IAAI,CAACoB,YAAY,EAAE;IAEjC,MAAMC,QAAQ,GAAGrB,IAAI,CAACqB,QAAQ,IAAIxB,MAAM;IACxC,MAAMyB,SAAS,GAAGC,QAAQ,CAACvB,IAAI,CAAClB,KAAK,CAAC,GAAG,CAAC,IAAIA,KAAK,GAAG,CAAC;IACvD,MAAM0C,OAAO,GAAGC,MAAM,CAACD,OAAO,CAACxB,IAAI,CAACoB,YAAY,CAAC;IACjD,MAAMM,aAAa,GAAGF,OAAO,CAACG,MAAM;IACpC,MAAMC,KAAK,GAAG,GAAG,GAAGN,SAAS,GAAG,GAAG;IAEnC,MAAMO,UAAU,GAAG7C,WAAW,CAACsB,OAAO,CAACwB,IAAI,CAAEhB,CAAC,IAAKA,CAAC,CAACjD,EAAE,KAAKgC,MAAM,CAAC;IACnE,MAAMkC,OAAO,GAAG,CAAAF,UAAU,aAAVA,UAAU,wBAAAzB,oBAAA,GAAVyB,UAAU,CAAEpE,QAAQ,cAAA2C,oBAAA,uBAApBA,oBAAA,CAAsB4B,CAAC,KAAI,CAAC;IAC5C,MAAMC,OAAO,GAAGC,IAAI,CAACC,GAAG,CAAC,GAAG,EAAE,IAAI,GAAGT,aAAa,CAAC;IACnD,MAAMU,MAAM,GAAGL,OAAO,GAAI,CAACL,aAAa,GAAG,CAAC,IAAIO,OAAO,GAAI,CAAC;IAE5DT,OAAO,CAACa,OAAO,CAAC,CAAC,CAACC,OAAO,EAAEC,UAAU,CAAC,EAAEC,KAAK,KAAK;MAChD,MAAMC,MAAM,GAAGL,MAAM,GAAGI,KAAK,GAAGP,OAAO;MAEvChD,QAAQ,CAACqB,OAAO,CAACoC,IAAI,CAAC;QACpB7E,EAAE,EAAE,KAAKgC,MAAM,IAAIyC,OAAO,EAAE;QAC5B3B,MAAM,EAAEd,MAAM;QACd8C,YAAY,EAAE,GAAG;QACjB9B,MAAM,EAAEyB,OAAO;QACfM,YAAY,EAAE,GAAG;QACjBC,QAAQ,EAAE;MACZ,CAAC,CAAC;MAEF7D,WAAW,CAACsB,OAAO,CAACoC,IAAI,CAAC;QACvB7E,EAAE,EAAEyE,OAAO;QACX3E,IAAI,EAAE,YAAY;QAClBF,QAAQ,EAAE;UAAEuE,CAAC,EAAES,MAAM;UAAEK,CAAC,EAAElB;QAAM,CAAC;QACjCzF,IAAI,EAAE;UACJgC,KAAK,EAAEoE,UAAU,CAACpE,KAAK;UACvBN,EAAE,EAAEyE,OAAO;UACXlE,WAAW,EAAEmE,UAAU,CAACnE,WAAW;UACnCK,QAAQ,EAAE,KAAK;UACfH,OAAO,EAAEA,CAAA,KAAM6B,WAAW,CAACmC,OAAO;QACpC;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;IAEFpD,gBAAgB,CAACoB,OAAO,CAACyC,GAAG,CAAClD,MAAM,CAAC;;IAEpC;IACAb,WAAW,CAACsB,OAAO,GAAGtB,WAAW,CAACsB,OAAO,CAACM,GAAG,CAACE,CAAC,IAC7CA,CAAC,CAACjD,EAAE,KAAKgC,MAAM,GACX;MACE,GAAGiB,CAAC;MACJ3E,IAAI,EAAE;QAAE,GAAG2E,CAAC,CAAC3E,IAAI;QAAEsC,QAAQ,EAAE;MAAK;IACpC,CAAC,GACDqC,CACN,CAAC;;IAED;IACA,MAAMkC,WAAW,GAAGC,KAAK,CAACC,IAAI,CAAC,IAAIC,GAAG,CAACnE,WAAW,CAACsB,OAAO,CAACM,GAAG,CAAEE,CAAC,IAAK,CAACA,CAAC,CAACjD,EAAE,EAAEiD,CAAC,CAAC,CAAC,CAAC,CAACsC,MAAM,CAAC,CAAC,CAAC;IAC3F,MAAMC,WAAW,GAAGJ,KAAK,CAACC,IAAI,CAAC,IAAIC,GAAG,CAAClE,QAAQ,CAACqB,OAAO,CAACM,GAAG,CAAEF,CAAC,IAAK,CAACA,CAAC,CAAC7C,EAAE,EAAE6C,CAAC,CAAC,CAAC,CAAC,CAAC0C,MAAM,CAAC,CAAC,CAAC;IAExF/D,QAAQ,CAAC2D,WAAW,CAAC;IACrBxD,QAAQ,CAAC6D,WAAW,CAAC;IACrBtE,QAAQ,CAACuC,SAAS,CAAC;EACrB,CAAC,EACD,CAACxC,KAAK,CACR,CAAC;EAED5D,SAAS,CAAC,MAAM;IACd,MAAMoI,QAAQ,GAAG,MAAAA,CAAA,KAAY;MAC3B,MAAMC,IAAI,GAAG,MAAM3D,SAAS,CAAC,OAAO,CAAC;MACrC,IAAI,CAAC2D,IAAI,EAAE;MAEX,MAAMC,MAAM,GAAGD,IAAI,CAAClC,QAAQ,IAAI,OAAO;MACvCrC,WAAW,CAACsB,OAAO,CAACoC,IAAI,CAAC;QACvB7E,EAAE,EAAE2F,MAAM;QACV7F,IAAI,EAAE,YAAY;QAClBF,QAAQ,EAAE;UAAEuE,CAAC,EAAE,GAAG;UAAEc,CAAC,EAAE;QAAG,CAAC;QAC3B3G,IAAI,EAAE;UACJgC,KAAK,EAAEoF,IAAI,CAACE,UAAU,IAAI,WAAW;UACrC5F,EAAE,EAAE2F,MAAM;UACVpF,WAAW,EAAE,IAAI;UACjBK,QAAQ,EAAE,KAAK;UACfH,OAAO,EAAEA,CAAA,KAAM6B,WAAW,CAACqD,MAAM;QACnC;MACF,CAAC,CAAC;MAEFnE,QAAQ,CAAC,CAAC,GAAGL,WAAW,CAACsB,OAAO,CAAC,CAAC;IACpC,CAAC;IACDgD,QAAQ,CAAC,CAAC;EACZ,CAAC,EAAE,CAACnD,WAAW,CAAC,CAAC;EAEjB,oBACElE,OAAA;IAAKa,KAAK,EAAE;MAAE4G,KAAK,EAAE,OAAO;MAAEC,MAAM,EAAE;IAAQ,CAAE;IAAAvH,QAAA,eAC9CH,OAAA,CAACT,SAAS;MACR4D,KAAK,EAAEA,KAAM;MACbG,KAAK,EAAEA,KAAM;MACbD,aAAa,EAAEA,aAAc;MAC7BG,aAAa,EAAEA,aAAc;MAC7BC,SAAS,EAAEA,SAAU;MACrBkE,OAAO;MACPC,cAAc,EAAE;QAAE7G,OAAO,EAAE;MAAI,CAAE;MAAAZ,QAAA,gBAEjCH,OAAA,CAACR,UAAU;QAAAqC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eACdhC,OAAA,CAACP,QAAQ;QAAAoC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACT,CAAC;AAEV,CAAC;AAACY,EAAA,CAtKID,UAAU;EAAA,QAM2BjD,aAAa,EACbC,aAAa;AAAA;AAAAkI,GAAA,GAPlDlF,UAAU;AAwKhB,eAAeA,UAAU;AAAC,IAAAD,EAAA,EAAAmF,GAAA;AAAAC,YAAA,CAAApF,EAAA;AAAAoF,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}